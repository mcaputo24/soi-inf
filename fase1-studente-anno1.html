<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fase 1 - Studente Anno I</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.28.1/cytoscape.min.js"></script>
  <style>
    #cy {
      width: 100%;
      height: 400px;
      border: 1px solid #ccc;
      margin: 20px 0;
    }
    table.flag-summary {
      width: 100%;
      margin-top: 20px;
      border-collapse: collapse;
    }
    table.flag-summary th, table.flag-summary td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: center;
    }
  </style>
</head>
<body>
  <header>
    <img src="logo.png" alt="Logo SOI">
    <h1>Sistema di Orientamento Integrato</h1>
  </header>

  <main>
    <h2>Dati anagrafici</h2>
    <form>
      <label>Nome: <input type="text" name="nome" required></label><br><br>
      <label>Cognome: <input type="text" name="cognome" required></label><br><br>
      <label>Classe: <input type="text" name="classe" required></label><br><br>
      <label>Data: <input type="date" name="data" required></label>

      <hr>

      <h2>Scheda 1 – Mappa di descrizione di sé</h2>
      <p>Elenca dieci aggettivi che ritieni essere i più adatti per descriverti:</p>
      <ol>
        <li><input type="text" name="agg1"></li>
        <li><input type="text" name="agg2"></li>
        <li><input type="text" name="agg3"></li>
        <li><input type="text" name="agg4"></li>
        <li><input type="text" name="agg5"></li>
        <li><input type="text" name="agg6"></li>
        <li><input type="text" name="agg7"></li>
        <li><input type="text" name="agg8"></li>
        <li><input type="text" name="agg9"></li>
        <li><input type="text" name="agg10"></li>
      </ol>
      <p>Utilizza alcuni aggettivi per costruire la tua mappa concettuale. Guarda l'esempio qui sotto:</p>
      <img src="mappa-esempio.png" alt="Esempio mappa" style="max-width: 100%; height: auto;">
      <div id="cy"></div>
      <p style="font-size: 14px; color: gray">Clicca per creare nodi e collegamenti alla tua mappa personale.</p>

      <hr>

      <h2>Scheda 2 – Un pensiero sul lavoro</h2>
      <label>Secondo te, cos'è il lavoro?<br><textarea name="cos_e_lavoro" rows="4" style="width: 100%;"></textarea></label><br><br>
      <label>Perché le persone lavorano?<br><textarea name="perche_lavoro" rows="4" style="width: 100%;"></textarea></label><br><br>
      <label>Se nessuno lavorasse, cosa succederebbe?<br><textarea name="senza_lavoro" rows="4" style="width: 100%;"></textarea></label><br><br>
      <label>Se penso al lavoro, mi sento...<br><textarea name="emozioni_lavoro" rows="2" style="width: 100%;"></textarea></label>

      <hr>

      <h2>Scheda 3 – Modi di lavorare</h2>
      <p>Seleziona le affermazioni che ti descrivono:</p>
      <fieldset id="checkbox-area">
        <!-- checkbox generate dinamicamente da JS -->
      </fieldset>
      <table class="flag-summary">
        <thead>
          <tr>
            <th>Lavorare con la GENTE</th>
            <th>Lavorare con le IDEE</th>
            <th>Lavorare con i DATI</th>
            <th>Lavorare con le COSE</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td id="sum-gente">0</td>
            <td id="sum-idee">0</td>
            <td id="sum-dati">0</td>
            <td id="sum-cose">0</td>
          </tr>
        </tbody>
      </table>

      <hr>

      <h2>Scheda 4 – Tutte le possibili strade</h2>
      <p>Quale o quali lavori ti piacerebbe fare da grande?<br><textarea name="lavori_preferiti" rows="3" style="width: 100%;"></textarea></p>
      <p>Come ti immagini mentre svolgi uno di questi lavori?<br><textarea name="immaginazione_lavoro" rows="3" style="width: 100%;"></textarea></p>
      <p>Perché pensi che questo lavoro faccia per te?<br><textarea name="motivazioni_lavoro" rows="4" style="width: 100%;"></textarea></p>
      <p>Quali desideri, sogni, obiettivi pensi di poter realizzare con questo lavoro?<br><textarea name="obiettivi" rows="4" style="width: 100%;"></textarea></p>
      <p>C'è qualcuno che ammiri o che ti ispira per il suo lavoro o modo di vivere?<br><textarea name="ispirazioni" rows="2" style="width: 100%;"></textarea></p>
    </form>
  </main>

  <script type="module">
    // Mappa interattiva
    const cy = cytoscape({
      container: document.getElementById('cy'),
      elements: [],
      style: [{ selector: 'node', style: { 'label': 'data(label)', 'background-color': '#007bff', 'color': '#fff' } },
              { selector: 'edge', style: { 'width': 2, 'line-color': '#999' } }],
      layout: { name: 'grid' }
    });
    
    cy.on('tap', function(event) {
      if (event.target === cy) {
        const id = 'n' + cy.elements().length;
        cy.add({ group: 'nodes', data: { id: id, label: prompt('Etichetta nodo?') }, position: event.position });
      } else if (event.target.isNode()) {
        const selected = cy.$(':selected');
        if (selected.length === 1 && selected[0] !== event.target) {
          cy.add({ group: 'edges', data: { source: selected[0].id(), target: event.target.id() } });
        }
        event.target.select();
      }
    });

    // Scheda 3 - Affermazioni con conteggio
    const categorie = {
      "gente": [
        "Ti piace lavorare in gruppo",
        "Aiuti spesso i compagni in difficoltà",
        "Ti esprimi con disinvoltura con gli altri"
      ],
      "idee": [
        "Ti piace leggere",
        "Ti piacciono le discussioni su temi importanti",
        "Hai il gusto della ricerca"
      ],
      "dati": [
        "Ti piacciono i calcoli",
        "Ti piace costruire grafici",
        "Sei molto ordinato"
      ],
      "cose": [
        "Ti piacciono i lavori manuali",
        "Ti piace costruire oggetti",
        "Ami la natura e il lavoro all'aperto"
      ]
    };

    const checkboxArea = document.getElementById('checkbox-area');
    const sumFields = {
      gente: document.getElementById('sum-gente'),
      idee: document.getElementById('sum-idee'),
      dati: document.getElementById('sum-dati'),
      cose: document.getElementById('sum-cose')
    };

    Object.entries(categorie).forEach(([cat, frasi]) => {
      frasi.forEach((testo, index) => {
        const id = `${cat}-${index}`;
        const label = document.createElement('label');
        const input = document.createElement('input');
        input.type = 'checkbox';
        input.id = id;
        input.dataset.cat = cat;
        label.appendChild(input);
        label.appendChild(document.createTextNode(' ' + testo));
        checkboxArea.appendChild(label);
        checkboxArea.appendChild(document.createElement('br'));
      });
    });

    checkboxArea.addEventListener('change', () => {
      const counts = { gente: 0, idee: 0, dati: 0, cose: 0 };
      checkboxArea.querySelectorAll('input[type="checkbox"]').forEach(cb => {
        if (cb.checked) counts[cb.dataset.cat]++;
      });
      Object.entries(counts).forEach(([cat, val]) => sumFields[cat].textContent = val);
    });
  </script>
</body>
</html>
